graph TB
    %% Client Layer
    subgraph "Client Layer"
        C1[Client 1<br/>Dataset D1]
        C2[Client 2<br/>Dataset D2]
        CN[Client N<br/>Dataset DN]
    end

    %% Client Components
    subgraph "Client Processing"
        LOCAL[Local Training<br/>SGD computation]
        QUANTIZE[Quantization<br/>8-bit compression]
        CLIENT_ZKP[Client ZKP<br/>zk-STARK generation]
    end

    %% Server Layer
    subgraph "Server Layer"
        SERVER[Secure FL Server<br/>Coordination hub]
        VERIFY[Proof Verification<br/>Validate client proofs]
        AGGREGATE[FedJSCM Aggregator<br/>Momentum-based]
        SERVER_ZKP[Server ZKP<br/>zk-SNARK generation]
    end

    %% Blockchain Layer
    subgraph "Blockchain Layer"
        SMART_CONTRACT[Smart Contract<br/>FLVerifier.sol]
        VALIDATORS[Validator Network<br/>Consensus mechanism]
    end

    %% ZKP Infrastructure
    subgraph "ZKP Infrastructure"
        STARK_SYSTEM[zk-STARK System<br/>Transparent, ~200KB]
        SNARK_SYSTEM[zk-SNARK System<br/>Succinct, ~200 bytes]
    end

    %% Data Flow
    C1 --> LOCAL
    C2 --> LOCAL
    CN --> LOCAL

    LOCAL --> QUANTIZE
    QUANTIZE --> CLIENT_ZKP
    CLIENT_ZKP --> VERIFY

    VERIFY --> AGGREGATE
    AGGREGATE --> SERVER_ZKP
    SERVER_ZKP --> SMART_CONTRACT

    SMART_CONTRACT --> VALIDATORS
    VALIDATORS --> SERVER

    SERVER --> C1
    SERVER --> C2
    SERVER --> CN

    %% ZKP Connections
    CLIENT_ZKP -.-> STARK_SYSTEM
    SERVER_ZKP -.-> SNARK_SYSTEM

    %% Styling
    classDef clientStyle fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px
    classDef serverStyle fill:#e3f2fd,stroke:#1565c0,stroke-width:2px
    classDef blockchainStyle fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef zkpStyle fill:#fff8e1,stroke:#f57c00,stroke-width:2px

    class C1,C2,CN,LOCAL,QUANTIZE,CLIENT_ZKP clientStyle
    class SERVER,VERIFY,AGGREGATE,SERVER_ZKP serverStyle
    class SMART_CONTRACT,VALIDATORS blockchainStyle
    class STARK_SYSTEM,SNARK_SYSTEM zkpStyle
